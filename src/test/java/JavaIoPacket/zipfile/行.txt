SELECT * FROM (SELECT ROWNUM ROWNO, T1.* FROM (
SELECT (select count(1) from (SELECT * FROM (SELECT VABI.ASSET_ID ASSET_ID, VABI.ASSET_DICT_ID,
 VABI.ASSET_NO ASSET_NO,
 AD.ASSET_NAME AS ASSET_NAME,
 VABI.SPEC SPEC,
 VABI.TYPE TYPE1,
 SCI5.ITEM_NAME AS UNITS_NAME,
 VABI.PRODUCT_DATE,
 VABI.MANUFACTURER_TEL,
 VABI.AGENT_TEL,
 VABI.GUARANTEE_DATE,
 VABI.CERTIFICATE_DUE_DATE,
 VABI.DEPT DEPT_ID_1,
 SDD1.DEPT_CODE DEPT_ID,
 SDD1.DEPT_NAME DEPT,
 VABI.USE_DEPT USE_DEPT_ID_1,
 SDD2.DEPT_CODE USE_DEPT_ID,
 SDD2.DEPT_NAME USE_DEPT,
 VABI.BUY_DATE,
 VABI.TRUSTEE TRUSTEE_ID,
 (CASE
 WHEN VABI.TRUSTEE IS NULL THEN
 VABI.TRUSTEE
 ELSE
 VABI.TRUSTEE || '-' || SUE1.USER_NAME
 END) AS TRUSTEE,
 VABI.AMOUNT AMOUNT,
 VABI.PRICE PRICE,
 NVL(VABI.PRICE, 0) * NVL(VABI.AMOUNT, 0) AS ASSET_TOTAL,
 VABI.STATUS STATUS_ID,
 SCI6.ITEM_NAME AS STATUS,
 VABI.MEMO MEMO1,
 VABI.ASSET_TYPE_ID ASSET_TYPE_ID,
 ATD.ASSET_TYPE_NAME ASSET_TYPE_NAME,
 ATD.ASSET_TYPE_CODE,
 VABI.ASSET_SUB_TYPE_ID ASSET_SUB_TYPE_ID,
 ASTD.ASSET_SUB_TYPE_NAME ASSET_SUB_TYPE_NAME,
 VABI.ACCT_INDICATOR,
 VABI.ASSET_ADDITION_NO1,
 VABI.ASSET_ADDITION_NO2,
 F.PHOTO_PATH, VABI.USE_YEARS,
 VABI.USE_YEARS2,
 AC.CODE_NO,
 AC.CODE_NAME,
 AC.CODE32,
 AC.CODE68,
 CASE
       WHEN VABI.SUPPLIER_INFO_ID IS NOT NULL THEN
        ASI.SUPPLIER_NAME
       ELSE
        VABI.AGENT
     END AS AGENT, VABI.ASSET_GENRE,
 SCI12.ITEM_NAME AS ASSET_GENRE_NAME,
 VABI.SEQ_NO,
 VABI.RECIPIENTS_USER,
 VABI.RECIPIENTS_DATE,
 VABI.RECIPIENTS_NO,
 VABI.BUY_BY,
 VABI.START_USING_DATE,
 SUE4.USER_NAME AS DEAL_ENGINEER_NAME,
 VABI.DEAL_ENGINEER,
 VABI.JC_ASSET_NO,
 (SELECT COUNT(1)
 FROM ASSET_BASIC_PART ABP
 WHERE ABP.ASSET_ID = VABI.ASSET_ID) AS PART_NUM,
 VABI.IMPORT_DATE,
 CASE
      WHEN VABI.MANUFACTURER_ID IS NOT NULL THEN
       ASI1.SUPPLIER_NAME
      ELSE
       VABI.MANUFACTURER
    END AS MANUFACTURER, VABI.IS_IMPORT_ASSET,
 VABI.CONTARCT_NO,
 VABI.INVOICE_NO,
 VABI.SUPPLIER_INFO_ID,
 NVL(VABI.PRINT_INDICATOR, 'N') PRINT_INDICATOR,
 VABI.PRINTER_NAME,
 VABI.DEVICE_TYPE,
 SCI.ITEM_NAME AS DEVICE_TYPE_NAME,
 VABI.INSTALL_LOCATION,
 VABI.PRINT_DATE,
 TO_CHAR(VABI.ACCEPT_DATE, 'YYYY-MM-DD') ACCEPT_DATE,
 VABI.UPDATE_DATE,
 VABI.UPDATE_NAME,
 AI.ACCOUNT_TIME,
 VABI.UPDATOR,
 VABI.FINANCIAL_ACCOUNTING,
 VABI.ACCOUNTING_DATE,
 VABI.FINANCE_PROOF_NO,
 FS.FUND_SOURCE_NAME AS FUND_SOURCE_NAME,
 ABE.DEPRECIATION_MONTHS AS DEPRECIATION_MONTHS,
 AE.ASSET_EXPORT_NO,
 ABE.DEPRECIATION_MONTHS2 AS DEPRECIATION_MONTHS2,
 VABI.FINANCIAL_NO,
 AI.IMPORT_NO,
 APM.PURCHASE_NO,
 AID.ASSET_DETAIL_ID,
 APD.PURCHASE_DETAIL_ID,
 VABI.BIDDING_NO,
 ABE.REMAINING_TOTAL,
 ABE.REMAINING_TOTAL2,
 (select max(TO_CHAR(CHANGE_DATE, 'YYYY-MM-DD')) from ASSET_INFO_CHANGE where asset_id=VABI.asset_id)as CHANGE_DATE,
 VABI.APPLY_NO
 FROM ASSET_BASIC_INFO VABI  INNER JOIN (SELECT DISTINCT ASSET_TYPE_ID FROM ASSET_SYS_USER_AT_PERM WHERE USER_ID='JJDD'  ) ATPS ON VABI.ASSET_SUB_TYPE_ID = ATPS.ASSET_TYPE_ID  LEFT JOIN ASSET_BASIC_EXT ABE  ON VABI.ASSET_ID = ABE.ASSET_ID  AND VABI.ORG_ID = ABE.ORG_ID LEFT JOIN ASSET_DICT AD
    ON VABI.ASSET_DICT_ID = AD.ASSET_DICT_ID --资产字典
    AND VABI.ORG_ID = AD.ORG_ID  LEFT JOIN (SELECT WM_CONCAT(S.ITEM_NAME) FUND_SOURCE_NAME,
                          I.ASSET_ID,I.ORG_ID
                     FROM ASSET_BASIC_FUND_SOURCE I
                     LEFT JOIN SYS_CODE_ITEM S
                       ON S.ITEM_ID = I.FUND_SOURCE                        AND I.ORG_ID = S.ORG_ID
                    GROUP BY ASSET_ID,I.ORG_ID) FS
           ON VABI.ASSET_ID = FS.ASSET_ID LEFT JOIN SYS_USER_EXT SUE4 ON SUE4.USER_ID = VABI.DEAL_ENGINEER  AND SUE4.ORG_ID = VABI.ORG_ID --维修人姓名
 LEFT JOIN SYS_CODE_ITEM SCI12 ON SCI12.DICT_ID = '569'  AND SCI12.ITEM_ID = VABI.ASSET_GENRE AND SCI12.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_CODE AC ON AC.CODE_NO = VABI.CODE_NO  AND AC.ORG_ID = VABI.ORG_ID --国家码
 LEFT JOIN ASSET_SUB_TYPE_DICT ASTD ON ASTD.ASSET_SUB_TYPE_ID = VABI.ASSET_SUB_TYPE_ID  AND ASTD.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_TYPE_DICT ATD ON ATD.ASSET_TYPE_ID = VABI.ASSET_TYPE_ID AND ATD.ORG_ID = VABI.ORG_ID
 LEFT JOIN SYS_CODE_ITEM SCI5 ON SCI5.DICT_ID = '517' AND SCI5.ITEM_ID = VABI.UNITS AND SCI5.ORG_ID = VABI.ORG_ID 
 LEFT JOIN SYS_CODE_ITEM SCI6 ON SCI6.DICT_ID = '518' AND SCI6.ITEM_ID = VABI.STATUS AND SCI6.ORG_ID = VABI.ORG_ID 
 LEFT JOIN SYS_USER_EXT SUE1 ON SUE1.USER_ID = VABI.TRUSTEE AND SUE1.ORG_ID = VABI.ORG_ID --保管人
 LEFT JOIN V_ASSET_DEPT_INFO SDD2 ON SDD2.SERIAL_NO = VABI.USE_DEPT  AND SDD2.ORG_ID = VABI.ORG_ID
 LEFT JOIN V_ASSET_DEPT_INFO SDD1 ON SDD1.SERIAL_NO = VABI.DEPT  AND SDD1.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_IMPORT_D AID ON AID.ASSET_DETAIL_ID = VABI.ASSET_DETAIL_ID  AND AID.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_IMPORT AI ON AI.ASSET_IMPORT_ID = AID.ASSET_IMPORT_ID
 LEFT JOIN ASSET_EXPORT_DETAIL AEXD ON AEXD.ASSET_EXPORT_DETAIL_ID = VABI.ASSET_EXPORT_DETAIL_ID AND AEXD.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_EXPORT AE ON AE.ASSET_EXPORT_ID = AEXD.ASSET_EXPORT_ID LEFT JOIN ASSET_CHECK_ACCEPTANCE ACA  ON ACA.ASSET_CHECK_ACCEPTANCE_ID = AID.ASSET_CHECK_ACCEPTANCE_ID LEFT JOIN ASSET_PURCHASE_DETAIL APD
  ON (APD.PURCHASE_DETAIL_ID = AID.PURCHASE_DETAIL_ID)
 OR (APD.PURCHASE_DETAIL_ID = ACA.PURCHASE_DETAIL_ID)
 LEFT JOIN ASSET_PURCHASE_MASTER APM
   ON APM.PURCHASE_ID = APD.PURCHASE_ID LEFT JOIN ASSET_SUPPLIER_INFO ASI
  ON ASI.SUPPLIER_INFO_ID = VABI.SUPPLIER_INFO_ID
  AND ASI.ORG_ID = VABI.ORG_ID LEFT JOIN ASSET_SUPPLIER_INFO ASI1
  ON ASI1.SUPPLIER_INFO_ID = VABI.MANUFACTURER_ID
  AND ASI1.ORG_ID = VABI.ORG_ID  LEFT JOIN SYS_CODE_ITEM SCI
  ON SCI.ITEM_ID = VABI.DEVICE_TYPE
 AND SCI.ORG_ID = VABI.ORG_ID LEFT JOIN (SELECT SAI.ATTACH_PATH ||
 '@PATH_CONFIG+' ||
 SAI.ATTACH_CONFIG_ID AS PHOTO_PATH,
 AA.ATTACHMENT_ID
 FROM ASSET_ATTACHMENT    AA,
 SYS_ATTACHMENT_INFO SAI
 WHERE SAI.ATTACH_ID = AA.ATTACH_ID) F
 ON F.ATTACHMENT_ID = VABI.ATTACHMENT_ID  WHERE (EXISTS (SELECT 1 FROM (SELECT DISTINCT S.DEPT_ID  FROM ASSET_SYS_USER_AMD_PERM S WHERE S.USER_ID = 'JJDD') ADPS WHERE VABI.DEPT = ADPS.DEPT_ID ) OR VABI.USE_DEPT IN (SELECT SERIAL_NO FROM V_ASSET_DEPT_INFO WHERE DEPT_CODE = '1.4.2.001')OR VABI.DEPT IN (SELECT SERIAL_NO FROM V_ASSET_DEPT_INFO WHERE DEPT_CODE = '1.4.2.001')) AND VABI.STATUS IN (  '518-1' , '518-9', '518-10', '518-5' )   AND TO_CHAR(VABI.USE_DEPT) IN(:id0,:id1,:id2) ) ORDER BY ASSET_NAME ASC,USE_DEPT,ASSET_ID ASC)) AS DATAGRID_DATA_TOTALS,T2.* FROM (SELECT * FROM (SELECT VABI.ASSET_ID ASSET_ID, VABI.ASSET_DICT_ID,
 VABI.ASSET_NO ASSET_NO,
 AD.ASSET_NAME AS ASSET_NAME,
 VABI.SPEC SPEC,
 VABI.TYPE TYPE1,
 SCI5.ITEM_NAME AS UNITS_NAME,
 VABI.PRODUCT_DATE,
 VABI.MANUFACTURER_TEL,
 VABI.AGENT_TEL,
 VABI.GUARANTEE_DATE,
 VABI.CERTIFICATE_DUE_DATE,
 VABI.DEPT DEPT_ID_1,
 SDD1.DEPT_CODE DEPT_ID,
 SDD1.DEPT_NAME DEPT,
 VABI.USE_DEPT USE_DEPT_ID_1,
 SDD2.DEPT_CODE USE_DEPT_ID,
 SDD2.DEPT_NAME USE_DEPT,
 VABI.BUY_DATE,
 VABI.TRUSTEE TRUSTEE_ID,
 (CASE
 WHEN VABI.TRUSTEE IS NULL THEN
 VABI.TRUSTEE
 ELSE
 VABI.TRUSTEE || '-' || SUE1.USER_NAME
 END) AS TRUSTEE,
 VABI.AMOUNT AMOUNT,
 VABI.PRICE PRICE,
 NVL(VABI.PRICE, 0) * NVL(VABI.AMOUNT, 0) AS ASSET_TOTAL,
 VABI.STATUS STATUS_ID,
 SCI6.ITEM_NAME AS STATUS,
 VABI.MEMO MEMO1,
 VABI.ASSET_TYPE_ID ASSET_TYPE_ID,
 ATD.ASSET_TYPE_NAME ASSET_TYPE_NAME,
 ATD.ASSET_TYPE_CODE,
 VABI.ASSET_SUB_TYPE_ID ASSET_SUB_TYPE_ID,
 ASTD.ASSET_SUB_TYPE_NAME ASSET_SUB_TYPE_NAME,
 VABI.ACCT_INDICATOR,
 VABI.ASSET_ADDITION_NO1,
 VABI.ASSET_ADDITION_NO2,
 F.PHOTO_PATH, VABI.USE_YEARS,
 VABI.USE_YEARS2,
 AC.CODE_NO,
 AC.CODE_NAME,
 AC.CODE32,
 AC.CODE68,
 CASE
       WHEN VABI.SUPPLIER_INFO_ID IS NOT NULL THEN
        ASI.SUPPLIER_NAME
       ELSE
        VABI.AGENT
     END AS AGENT, VABI.ASSET_GENRE,
 SCI12.ITEM_NAME AS ASSET_GENRE_NAME,
 VABI.SEQ_NO,
 VABI.RECIPIENTS_USER,
 VABI.RECIPIENTS_DATE,
 VABI.RECIPIENTS_NO,
 VABI.BUY_BY,
 VABI.START_USING_DATE,
 SUE4.USER_NAME AS DEAL_ENGINEER_NAME,
 VABI.DEAL_ENGINEER,
 VABI.JC_ASSET_NO,
 (SELECT COUNT(1)
 FROM ASSET_BASIC_PART ABP
 WHERE ABP.ASSET_ID = VABI.ASSET_ID) AS PART_NUM,
 VABI.IMPORT_DATE,
 CASE
      WHEN VABI.MANUFACTURER_ID IS NOT NULL THEN
       ASI1.SUPPLIER_NAME
      ELSE
       VABI.MANUFACTURER
    END AS MANUFACTURER, VABI.IS_IMPORT_ASSET,
 VABI.CONTARCT_NO,
 VABI.INVOICE_NO,
 VABI.SUPPLIER_INFO_ID,
 NVL(VABI.PRINT_INDICATOR, 'N') PRINT_INDICATOR,
 VABI.PRINTER_NAME,
 VABI.DEVICE_TYPE,
 SCI.ITEM_NAME AS DEVICE_TYPE_NAME,
 VABI.INSTALL_LOCATION,
 VABI.PRINT_DATE,
 TO_CHAR(VABI.ACCEPT_DATE, 'YYYY-MM-DD') ACCEPT_DATE,
 VABI.UPDATE_DATE,
 VABI.UPDATE_NAME,
 AI.ACCOUNT_TIME,
 VABI.UPDATOR,
 VABI.FINANCIAL_ACCOUNTING,
 VABI.ACCOUNTING_DATE,
 VABI.FINANCE_PROOF_NO,
 FS.FUND_SOURCE_NAME AS FUND_SOURCE_NAME,
 ABE.DEPRECIATION_MONTHS AS DEPRECIATION_MONTHS,
 AE.ASSET_EXPORT_NO,
 ABE.DEPRECIATION_MONTHS2 AS DEPRECIATION_MONTHS2,
 VABI.FINANCIAL_NO,
 AI.IMPORT_NO,
 APM.PURCHASE_NO,
 AID.ASSET_DETAIL_ID,
 APD.PURCHASE_DETAIL_ID,
 VABI.BIDDING_NO,
 ABE.REMAINING_TOTAL,
 ABE.REMAINING_TOTAL2,
 (select max(TO_CHAR(CHANGE_DATE, 'YYYY-MM-DD')) from ASSET_INFO_CHANGE where asset_id=VABI.asset_id)as CHANGE_DATE,
 VABI.APPLY_NO
 FROM ASSET_BASIC_INFO VABI  INNER JOIN (SELECT DISTINCT ASSET_TYPE_ID FROM ASSET_SYS_USER_AT_PERM WHERE USER_ID='JJDD'  ) ATPS ON VABI.ASSET_SUB_TYPE_ID = ATPS.ASSET_TYPE_ID  LEFT JOIN ASSET_BASIC_EXT ABE  ON VABI.ASSET_ID = ABE.ASSET_ID  AND VABI.ORG_ID = ABE.ORG_ID LEFT JOIN ASSET_DICT AD
    ON VABI.ASSET_DICT_ID = AD.ASSET_DICT_ID --资产字典
    AND VABI.ORG_ID = AD.ORG_ID  LEFT JOIN (SELECT WM_CONCAT(S.ITEM_NAME) FUND_SOURCE_NAME,
                          I.ASSET_ID,I.ORG_ID
                     FROM ASSET_BASIC_FUND_SOURCE I
                     LEFT JOIN SYS_CODE_ITEM S
                       ON S.ITEM_ID = I.FUND_SOURCE                        AND I.ORG_ID = S.ORG_ID
                    GROUP BY ASSET_ID,I.ORG_ID) FS
           ON VABI.ASSET_ID = FS.ASSET_ID LEFT JOIN SYS_USER_EXT SUE4 ON SUE4.USER_ID = VABI.DEAL_ENGINEER  AND SUE4.ORG_ID = VABI.ORG_ID --维修人姓名
 LEFT JOIN SYS_CODE_ITEM SCI12 ON SCI12.DICT_ID = '569'  AND SCI12.ITEM_ID = VABI.ASSET_GENRE AND SCI12.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_CODE AC ON AC.CODE_NO = VABI.CODE_NO  AND AC.ORG_ID = VABI.ORG_ID --国家码
 LEFT JOIN ASSET_SUB_TYPE_DICT ASTD ON ASTD.ASSET_SUB_TYPE_ID = VABI.ASSET_SUB_TYPE_ID  AND ASTD.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_TYPE_DICT ATD ON ATD.ASSET_TYPE_ID = VABI.ASSET_TYPE_ID AND ATD.ORG_ID = VABI.ORG_ID
 LEFT JOIN SYS_CODE_ITEM SCI5 ON SCI5.DICT_ID = '517' AND SCI5.ITEM_ID = VABI.UNITS AND SCI5.ORG_ID = VABI.ORG_ID 
 LEFT JOIN SYS_CODE_ITEM SCI6 ON SCI6.DICT_ID = '518' AND SCI6.ITEM_ID = VABI.STATUS AND SCI6.ORG_ID = VABI.ORG_ID 
 LEFT JOIN SYS_USER_EXT SUE1 ON SUE1.USER_ID = VABI.TRUSTEE AND SUE1.ORG_ID = VABI.ORG_ID --保管人
 LEFT JOIN V_ASSET_DEPT_INFO SDD2 ON SDD2.SERIAL_NO = VABI.USE_DEPT  AND SDD2.ORG_ID = VABI.ORG_ID
 LEFT JOIN V_ASSET_DEPT_INFO SDD1 ON SDD1.SERIAL_NO = VABI.DEPT  AND SDD1.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_IMPORT_D AID ON AID.ASSET_DETAIL_ID = VABI.ASSET_DETAIL_ID  AND AID.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_IMPORT AI ON AI.ASSET_IMPORT_ID = AID.ASSET_IMPORT_ID
 LEFT JOIN ASSET_EXPORT_DETAIL AEXD ON AEXD.ASSET_EXPORT_DETAIL_ID = VABI.ASSET_EXPORT_DETAIL_ID AND AEXD.ORG_ID = VABI.ORG_ID
 LEFT JOIN ASSET_EXPORT AE ON AE.ASSET_EXPORT_ID = AEXD.ASSET_EXPORT_ID LEFT JOIN ASSET_CHECK_ACCEPTANCE ACA  ON ACA.ASSET_CHECK_ACCEPTANCE_ID = AID.ASSET_CHECK_ACCEPTANCE_ID LEFT JOIN ASSET_PURCHASE_DETAIL APD
  ON (APD.PURCHASE_DETAIL_ID = AID.PURCHASE_DETAIL_ID)
 OR (APD.PURCHASE_DETAIL_ID = ACA.PURCHASE_DETAIL_ID)
 LEFT JOIN ASSET_PURCHASE_MASTER APM
   ON APM.PURCHASE_ID = APD.PURCHASE_ID LEFT JOIN ASSET_SUPPLIER_INFO ASI
  ON ASI.SUPPLIER_INFO_ID = VABI.SUPPLIER_INFO_ID
  AND ASI.ORG_ID = VABI.ORG_ID LEFT JOIN ASSET_SUPPLIER_INFO ASI1
  ON ASI1.SUPPLIER_INFO_ID = VABI.MANUFACTURER_ID
  AND ASI1.ORG_ID = VABI.ORG_ID  LEFT JOIN SYS_CODE_ITEM SCI
  ON SCI.ITEM_ID = VABI.DEVICE_TYPE
 AND SCI.ORG_ID = VABI.ORG_ID LEFT JOIN (SELECT SAI.ATTACH_PATH ||
 '@PATH_CONFIG+' ||
 SAI.ATTACH_CONFIG_ID AS PHOTO_PATH,
 AA.ATTACHMENT_ID
 FROM ASSET_ATTACHMENT    AA,
 SYS_ATTACHMENT_INFO SAI
 WHERE SAI.ATTACH_ID = AA.ATTACH_ID) F
 ON F.ATTACHMENT_ID = VABI.ATTACHMENT_ID  WHERE (EXISTS (SELECT 1 FROM (SELECT DISTINCT S.DEPT_ID  FROM ASSET_SYS_USER_AMD_PERM S WHERE S.USER_ID = 'JJDD') ADPS WHERE VABI.DEPT = ADPS.DEPT_ID ) OR VABI.USE_DEPT IN (SELECT SERIAL_NO FROM V_ASSET_DEPT_INFO WHERE DEPT_CODE = '1.4.2.001')OR VABI.DEPT IN (SELECT SERIAL_NO FROM V_ASSET_DEPT_INFO WHERE DEPT_CODE = '1.4.2.001')) AND VABI.STATUS IN (  '518-1' , '518-9', '518-10', '518-5' )   AND TO_CHAR(VABI.USE_DEPT) IN(:id0,:id1,:id2) ) ORDER BY ASSET_NAME ASC,USE_DEPT,ASSET_ID ASC) T2
) T1  WHERE ROWNUM <= 50) TT WHERE TT.ROWNO > 0	